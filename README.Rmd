---
title: "BayesMultiMode"
output: github_document
bibliography: inst/REFERENCES.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(dpi=600)
```
<!-- badges: start -->
[![R-CMD-check](https://github.com/paullabonne/BayesMultiMode/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/paullabonne/BayesMultiMode/actions/workflows/R-CMD-check.yaml)
[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/BayesMultiMode)](https://cran.r-project.org/package=BayesMultiMode)
<!-- badges: end -->

An R package for detecting and exploring multimodality using Bayesian techniques. The approach works in two stages. First, a mixture distribution is fitted on the data. The number of mixture components does not have to be specified; it can be estimated simultaneously with the mixture weights and components through a Sparse Finite Mixture approach. Second, the resulting MCMC draws are used to calculate the number of modes and their locations. Posterior probabilities are retrieved for both of these quantities providing a powerful tool for mode inference. 

### Installing BayesMultiMode from CRAN
```{r, eval = FALSE}
install.packages("BayesMultiMode")
```

### Or installing the development version from GitHub
```{r, eval = FALSE}
# install.packages("devtools") # if devtools is not installed 
devtools::install_github("paullabonne/BayesMultiMode")
```

### Loading BayesMultiMode
```{r}
library(BayesMultiMode)
```

### Illustration with discrete data

#### Estimation
```{r, out.width = '70%', fig.align = "center"}
# retreive DNA data
y = d4z4

# estimation
bayesmix = bayes_estimation(data = y,
                            K = 5,
                            dist = "shifted_poisson",
                            nb_iter = 2000,
                            burnin = 1000)

# plot estimated mixture
plot(bayesmix, max_size = 200)
```

#### Mode inference
```{r, out.width = '70%', fig.align = "center"}
# mode estimation
bayesmode = bayes_mode(bayesmix)

# plot 
plot(bayesmode, max_size = 200)
```


### Illustration with continuous data

#### Estimation
```{r, out.width = '70%', fig.align = "center"}
# retreive galaxy data
y = galaxy

# estimation
bayesmix = bayes_estimation(data = y,
                            K = 4,
                            dist = "normal",
                            nb_iter = 2000,
                            burnin = 1000,
                            chains = 1,
                            G0 = 0)

# plot estimated mixture
plot(bayesmix, max_size = 200)
```

#### Mode inference
```{r, out.width = '70%', fig.align = "center"}
# Mode Estimation
bayesmode = bayes_mode(bayesmix)

# Plot 
plot(bayesmode, max_size = 200)
```

### References
[@basturk_bayes_2021]
[@malsiner-walli_model-based_2016]
[@schaap_genome-wide_2013]
