## Loading package
```{r}
library(BayesMultiMode)
```

## 
```{r}
# roxygen2::roxygenize()
devtools::document()

devtools::test()

devtools::run_examples()

devtools::install()

devtools::build_manual()

devtools::build()

devtools::check()

devtools::check_rhub()

devtools::test_coverage()

devtools::submit_cran()

devtools::spell_check()
```

#### Loading all functions for testing before installing
```{r, eval = FALSE}
devtools::load_all()

#devtools::test()
```

#### test_neg_binom
```{r, eval = FALSE}
# Set seed for reproducibility
set.seed(123) 

# Simulate data
N <- 1000  # Number of observations
J <- 2     # Number of components
p <- c(0.5, 0.5)  # Component probabilities

# True parameters of DGP
true_Mu <- c(1, 15)  # True mean
true_R <- c(2, 10)   # True shape parameter

true_P <- true_Mu / (true_R + true_Mu)  # p = mu/(r+mu)
P_R <- 1 - true_P  # R specification of NB uses 1-p

# Simulate components
Y1 <- rnbinom(round(p[1] * N), size = true_R[1], prob = P_R[1])
Y2 <- rnbinom(round(p[2] * N), size = true_R[2], prob = P_R[2])

kappa <- c(10,0)
Y <- c(Y1 + kappa[1], Y2+ kappa[2])

hist(Y)
```

# dna



```{r, eval = FALSE}
x <- 0:34
freq.x <- c(3002, 502, 187, 138, 233, 160, 107, 80, 59, 53, 41, 28, 34, 10, 13, 11, 4, 5, 8, 6, 3, 0, 1, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1) 

# create whole data
y <- rep(x[1], freq.x[1])

for(i in 1:34){
  tmp <- rep(x[i + 1], freq.x[i + 1])
  y <- c(y, tmp)
}

hist(y)
Y = y
```

```{r, eval = FALSE}
set.seed(123)

# retrieve galaxy data
y = Y

# estimation
bayesmix = bayes_fit(data = y,
                     K = 5,
                     dist = "shifted_neg_binomial",
                     nb_iter = 2000,
                     burnin = 1000,
                     print = T)

plot(bayesmix, draws = 200)
bayes_trace(bayesmix)
```

```{r, out.width = '70%', fig.align = "center"}
# mode estimation
bayesmode = bayes_mode(bayesmix)

plot(bayesmode)

summary(bayesmode)
```