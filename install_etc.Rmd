## Loading package
```{r}
library(BayesMultiMode)
```

## 
```{r}
roxygen2::roxygenize()
devtools::document()

devtools::test()

devtools::install()

devtools::build_manual()

devtools::check()
```

#### Loading all functions for testing before installing
```{r, eval = FALSE}
devtools::load_all()
```

#### Testing / https://r-pkgs.org/testing-design.html
```{r}
library(usethis)
# use_r("MEM")    # creates and opens R/fixed_point.R
use_test("new_BayesMixture") # creates and opens tests/testthat/test-fixed_point.R
```

### DNA data
```{r, eval=TRUE}
ct47 = c(6,7,6,9,7,10,6,7,4,7,5,10,7,8,7,8,7,7,5,8,8,8,7,8,6,8,5,8,7,7,7,11,8,8,8,10,8,17,6,8,7,7,9,10,7,7,7,7,5,8,6,8,5,6,4,6,6,7,4,7,5,9,6,7,5,7,5,12,5,10,5,5,5,8,4,7,5,6,5,9,4,7,7,7,7,7,5,6,4,5,4,7,7,4,7,8,6,6,5,5,5,8,6,5,4,5,5,6,6,4,6,6,5,6,5,12,7,5,6,5,6,6,5,5,5,6,6,6,9,7,6,6,7,8,7,8,7,7,6,10,4,9,6,7,7,10,7,7,6,7,6,6,8,9,7,10,8,9,8,9,8,9,7,8,9,7,8,7,7,7,8,10,10,8,9,6,8,7,8,5,7,7,8,4,8,6,6,6,7,6,7,8,7,6,7,9,5,7,8,9,9,8,10,9,9,8,9,8,7,8,8,8,9,7,6,6,4,6,8,8,7,8,7,9,6,7,5,8,4,6,6,7,5,6,7,9,7,8,6,6,7,8,5,5,5,5,7,11,6,7,7,7,8,8,5,6,7,8,5,7,6,6,5,5,5,5,6,7,5,8,7,9,6,15,6,9,6,9,5,8,7,8,5,9,6,7,4,6,5,7,8,8,7,5,9,6,7,8,5,5,6,5,5,6,6,7,13,9)

d4z4 = c(21,26,23,36,16,22,18,28,30,37,26,29,25,40,20,41,26,28,30,36,25,35,10,23,27,50,6,15,24,26,40,17,23,13,24,18,12,42,17,22,11,22,14,26,16,19,13,27,12,14,19,21,27,13,40,61,13,39,18,30,12,23,18,20,24,30,6,13,20,57,14,17,12,25,21,37,10,17,40,44,19,26,6,23,13,19,21,21,22,30,14,31,17,36,22,30,26,29,25,38,17,26,32,18,28,17,22,16,65,14,17,22,29,14,39,17,17,14,28,7,13,13,14,9,34,22,24,24,29,20,37,21,31,24,38,15,24,18,24,20,26,17,17,18,24,17,49,20,23,26,40,12,21,36,58,17,24,18,21,9,20,13,24,23,26,9,35,14,27,17,38,13,22,23,33,15,27,20,48,20,25,27,27,20,24,53,69,22,45,30,37,31,67,11,50,13,15,44,54,35,48,18,23,23,57,27,52,21,38,27,30,17,70,18,25,15,29,30,46,20,32,16,108,26,16,21,25,30,20,57,37,45,27,31,25,50,32,49,25,32,57,20,20,20,29,57,17,26,31,14,23,29,29,50,24,113,22,27,24,38,25,56,43,50,36,48,53,61,21,67,23,40,27,56,23,35,58,22,41,29,27,21,50,10,57,15,39,20,58,21,28,26,30,29,76,9,37,24,47,8,45,37,58,24,75,11,40,19,48,6,29,34,66,25,96,23,33,18,32,23,43,53,13,41,37,41,41,52,29,35,41,90,25,87,24,31,7,61,22,26,41,29,38,24,27,46,53,20,43,11,18,16,29,18,35,25,30,19,24,90,16,21,7,20,23,24,9,72,24,52,8,14,39,72,26,26,13,44,7,39,44,53,43,47,33,72,57,90,28,72,17,43,19,26,72,28,42,29,63,22,46,7,84,24,27,8,13,9,41,9,36)

msr5p = c(21,31,26,38,36,53,46,53,57,65,27,56,14,45,21,55,30,48,26,37,44,76,21,43,53,61,27,47,41,105,46,51,26,42,40,48,32,51,29,83,48,48,40,62,33,46,46,50,40,42,21,26,24,28,23,70,28,36,25,36,25,47,26,35,27,39,12,64,18,75,53,61,43,43,43,80,23,40,36,49,22,43,47,68,17,30,29,38,48,48,37,64,48,56,38,60,21,41,37,46,36,40,40,40,58,72,36,51,47,49,31,45,35,53,26,53,52,56,40,40,22,39,47,47,24,31,44,53,63,66,12,60,25,41,26,33,33,53,20,57,8,53,23,48,27,38,27,93,36,36,38,50,40,56,24,38,27,32,43,47,24,26,33,44,42,47,47,73,20,40,22,39,25,34,34,47,35,38,54,54,51,78,43,80,62,62,44,66,49,64,47,54,58,62,68,68,43,50,53,78,36,65,39,61,26,34,68,83,52,68,59,79,58,100,58,83,55,77,42,63,51,63,42,47,51,58,51,70,56,82,56,76,54,61,50,53,51,55,44,58,43,81,54,57,53,53,43,64,65,70,33,38,41,55,45,81,46,46,56,56,51,61,53,78,43,53,55,55,62,66,46,51,48,53,53,78,42,131,53,61,47,54,15,36,66,66,50,92,34,79,52,66,35,50,54,57,49,80,49,69,75,79,49,56,71,89,20,93,35,87,39,42,58,66,57,62,57,76,65,69,66,73,71,79,50,97,101,113,57,63,17,68,42,48,81,91,64,64,37,69,81,81,93,103,27,43,51,65,41,57,47,58,51,94,67,78,40,54,54,63,53,61,34,48,45,55,68,73,45,48,36,44,46,79,58,73,79,79,66,77,53,90,31,75,53,70,45,45,46,86,50,55,77,83,31,71)

save(ct47, file="data/ct47.rda")
save(d4z4, file="data/d4z4.rda")
save(msr5p, file="data/msr5p.rda")
```

### data
```{r, eval=TRUE}
# source : https://people.maths.bris.ac.uk/~mapjg/mixdata (Richardson S, Green PJ (1997)

# galaxy
galaxy = c(9.172, 9.350,9.483,9.558,9.775,10.227,10.406,16.084,16.170,18.419,
           18.552,18.600,18.927,19.052,19.070,19.330,19.343,19.349,19.440,19.473,
           19.529,19.541,19.547,19.663,19.846,19.856,19.863,19.914,19.918,19.973,
           19.989,20.166,20.175,20.179,20.196,20.215,20.221,20.415,20.629,20.795,
           20.821,20.846,20.875,20.986,21.137,21.492,21.701,21.814,21.921,21.960,
           22.185,22.209,22.242,22.249,22.314,22.374,22.495,22.746,22.747,22.888,
           22.914,23.206,23.241,23.263,23.484,23.538,23.542,23.666,23.706,23.711,
           24.129,24.285,24.289,24.366,24.717,24.990,25.633,26.960,26.995,32.065,
           32.789,34.279)

save(galaxy, file="data/galaxy.rda")

# enzyme
enzyme = c(0.130,0.080,1.261,0.224,0.132,1.052,0.085,0.124,0.718,0.280,0.687,
           0.106,0.088,0.137,0.096,0.124,0.126,1.279,1.007,0.195,0.167,0.213,
           0.108,1.371,0.190,0.184,1.298,1.036,0.205,1.950,1.018,0.172,0.148,
           0.292,0.113,0.185,0.129,1.329,0.149,0.236,2.545,1.073,0.162,2.518,
           0.142,2.880,0.178,1.075,0.128,0.083,0.409,0.340,0.246,1.195,1.452,
           1.123,1.361,0.222,0.962,0.875,0.078,0.520,0.194,1.195,0.709,0.021,
           0.166,0.081,0.265,0.159,0.308,1.604,0.179,0.172,0.131,0.305,0.215,
           0.214,0.853,0.137,0.466,1.419,2.016,1.944,1.040,1.200,0.255,0.232,
           0.200,0.240,0.216,0.277,2.427,0.320,0.142,0.134,0.198,0.126,1.173,
           0.342,1.672,0.193,1.633,0.860,1.293,0.207,1.811,1.741,1.488,0.124,
           1.326,0.148,0.109,1.848,1.310,0.118,1.004,0.204,0.192,0.299,1.885,
           0.264,0.230,0.250,0.061,0.953,0.138,0.313,0.174,1.768,1.369,0.130,
           1.113,0.320,0.190,0.818,1.461,0.149,0.291,0.225,1.622,0.185,0.198,
           0.360,0.387,2.338,1.713,0.368,1.573,0.309,0.232,0.347,0.325,1.861,
           0.258,0.258,1.625,0.291,1.169,0.210,0.241,0.112,0.183,0.258,0.357,
           1.176,0.111,0.978,0.279,1.742,0.184,0.230,0.275,2.183,2.264,1.405,
           0.408,0.126,0.263,0.162,0.902,1.516,0.293,0.198,0.118,0.305,0.031,
           0.192,0.151,0.182,0.909,0.379,1.010,0.167,0.929,0.083,0.179,1.567,
           1.241,0.077,0.166,1.271,0.100,1.229,0.152,1.374,0.157,1.003,0.084,
           0.171,0.953,0.192,0.967,1.300,0.122,1.036,0.200,0.070,0.998,0.176,
           0.673,0.839,0.867,0.985,0.096,0.238,0.933,1.231,0.162,0.044,0.175,
           0.132,1.166,0.144,0.180,0.945,0.180,0.152,0.108,0.923,0.192,0.895,
           0.176,0.191,1.161)

save(enzyme, file="data/enzyme.rda")

# acidity
acidity = c(2.928524,3.910021,3.732896,3.688879,3.822098,3.735286,4.143135,
            4.276666,3.931826,4.077537,4.779123,4.234107,4.276666,4.543295,
            6.467388,4.127134,3.977811,4.264087,4.007333,3.921973,5.384495,
            4.912655,4.046554,4.043051,4.406719,4.505350,3.931826,6.752270,
            6.928538,5.994460,4.248495,4.060443,4.727388,6.047372,4.082609,
            4.244200,4.890349,4.416428,5.743003,4.127134,5.489764,4.778283,
            5.249652,4.855929,4.128746,4.442651,4.025352,4.290459,4.593098,
            4.652054,4.178992,4.382027,5.569489,5.049856,4.188138,6.629363,
            4.647271,4.784989,4.348987,5.361292,4.574711,4.442651,6.120297,
            4.060443,4.143135,4.510860,6.049733,4.510860,4.406719,6.343880,
            4.430817,5.929589,5.973301,4.481872,4.301359,6.452680,4.204693,
            4.143135,6.603944,4.644391,5.863631,4.025352,5.717028,5.308268,
            6.267201,4.060443,5.017280,4.510860,5.834811,4.330733,4.007333,
            6.806829,5.257495,4.624973,4.781641,4.099332,7.044382,3.914021,
            4.330733,4.016383,5.572154,4.043051,4.843399,4.110874,4.454347,
            4.356709,6.154858,6.284321,6.978214,4.301359,5.929855,4.465908,
            6.035481,6.726473,7.105130,6.014937,4.882802,7.032095,4.518522,
            6.476665,6.125558,4.189655,5.323498,4.938065,6.313548,5.853925,
            6.278146,7.020191,5.023881,4.262680,6.725634,6.489205,5.743003,
            6.739337,6.466145,6.855409,5.120983,5.913773,6.516932,4.058717,
            6.213608,6.554218,6.155707,4.314818,6.662494,6.749931,6.100319,
            4.112512,6.946014,4.131961,6.234411,6.595781,6.683861,6.957973,
            4.497585)
save(acidity, file="data/acidity.rda")
```